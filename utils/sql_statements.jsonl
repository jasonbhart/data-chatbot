{"question": "What was the monthly trend of enrollments in 2023 from Jan 1 to Nov 13?", "sql": "SELECT EXTRACT(MONTH FROM enrollment_date) AS month, EXTRACT(YEAR FROM enrollment_date) AS year, COUNT(DISTINCT student_id) AS number_of_enrollments FROM dbt_models.student_ssa_final_model WHERE enrollment_date >= '2023-01-01' AND enrollment_date <= '2023-11-13' GROUP BY year, month ORDER BY year, month"}
{"question": "What was the monthly trend of enrollments for all time broken down by line of business?", "sql": "SELECT EXTRACT(MONTH FROM enrollment_date) AS month, EXTRACT(YEAR FROM enrollment_date) AS year, course_line AS line_of_business, COUNT(DISTINCT student_id) AS number_of_enrollments FROM dbt_models.student_ssa_final_model WHERE enrollment_date <= '2023-11-14' GROUP BY year, month, line_of_business ORDER BY year, month, line_of_business"}
{"question": "What were the quarterly enrollment counts for the last 2 years if today is Nov 13, 2023?", "sql": "SELECT EXTRACT(YEAR FROM enrollment_date) AS year, CONCAT('Q', CAST(EXTRACT(QUARTER FROM enrollment_date) AS STRING)) AS quarter, COUNT(DISTINCT student_id) AS number_of_student_enrollments FROM dbt_models.student_ssa_final_model WHERE enrollment_date >= '2022-01-01' AND enrollment_date <= '2023-12-31' GROUP BY year, quarter ORDER BY year, quarter"}
{"question": "How many students were refunded in October of 2023", "sql": "SELECT COUNT(DISTINCT student_id) AS refunded_people FROM dbt_models.student_ssa_final_model WHERE EXTRACT(MONTH FROM refund_date) = 10 AND EXTRACT(YEAR FROM refund_date) = 2023"}
{"question": "What was the refund rate monthly for this year if today is Nov 13, 2023?", "sql": "SELECT EXTRACT(MONTH FROM enrollment_date) AS month, EXTRACT(YEAR FROM enrollment_date) AS year, COUNT(DISTINCT CASE WHEN refund_date IS NOT NULL THEN student_id ELSE NULL END)/COUNT(DISTINCT student_id) AS refund_rate_pct FROM dbt_models.student_ssa_final_model WHERE enrollment_date >= '2023-01-01' AND enrollment_date <= '2023-11-13' GROUP BY year, month ORDER BY year, month"}
{"question": "How many students are currently active?", "sql": "SELECT COUNT(DISTINCT student_id) AS total_enrolled_students FROM dbt_models.student_ssa_final_model WHERE current_status = 'AC'"}
{"question": "Give me a list of mentors which are currently active", "sql": "SELECT mentor_id, first_name || ' ' || last_name AS mentor_name, num_of_students_currently_paired_with FROM dbt_models.mentor_ssa_final_model WHERE mentor_status = 'active'"}
{"question": "What was the application conversion rate for the cohort which included November 13, 2023?", "sql": ""}
{"question": "What was the breakdown of enrollments for October between the lines of business?", "sql": "SELECT course_line AS line_of_business, COUNT(DISTINCT student_id) AS number_of_enrollments FROM dbt_models.student_ssa_final_model WHERE EXTRACT(MONTH FROM enrollment_date) = 10 AND EXTRACT(YEAR FROM enrollment_date) = 2023 GROUP BY course_line"}